(()=>{"use strict";var e=function(e,n,o){t(e)?(n.classList.add(o.inactiveButtonClass),n.disabled=!0):(n.classList.remove(o.inactiveButtonClass),n.disabled=!1)},t=function(e){return e.some((function(e){return!e.validity.valid}))},n=function(t){Array.from(document.querySelectorAll(t.formSelector)).forEach((function(n){var o=Array.from(n.querySelectorAll(t.inputSelector)),r=n.querySelector(t.submitButtonSelector);!function(t,n,o,r){e(o,r,n),o.forEach((function(c){c.addEventListener("input",(function(){e(o,r,n),function(e,t,n){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,t.validationMessage,n)}(t,c,n)}))}))}(n,t,o,r)}))};function o(e){e.classList.add("popup_opened"),document.addEventListener("keydown",c)}function r(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",c)}function c(e){"Escape"===e.key&&r(document.querySelector(".popup_opened"))}function i(){return fetch("https://nomoreparties.co/v1/plus-cohort-26/users/me",{headers:{authorization:"019bbcb5-3c25-4998-9d5f-ecd3bb7b11a2"}})}document.querySelectorAll(".popup__overlay").forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return r(t)}))}));var u=document.querySelector(".elements");function a(e,t,n,r,c,u,a){var l=document.querySelector("#place-template").content.querySelector("#elements__item").cloneNode(!0);l.querySelector(".elements__img").src="".concat(t),l.querySelector(".elements__img").alt="".concat(e),l.querySelector(".elements__discritpion").textContent=e;var s=l.querySelector(".elements__likes");s.textContent=n;var f=l.querySelector(".elements__delet-icon"),d=l.querySelector(".elements__heart");return function(e,t,n,o,r,c){e.addEventListener("click",(function(i){e.classList.contains("elements__heart_active")?function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-26/cards/likes/".concat(e," "),{method:"DELETE",headers:{authorization:"019bbcb5-3c25-4998-9d5f-ecd3bb7b11a2"}})}(t).then((function(e){if(e.ok)for(var t=0;t<n;t++)console.log(c.textContent),r[t]===o&&r[t].remove()})).then((function(){c.textContent--})).catch((function(e){return console.log(e)})):!1===e.classList.contains("elements__heart_active")&&function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-26/cards/likes/".concat(e),{method:"PUT",headers:{authorization:"019bbcb5-3c25-4998-9d5f-ecd3bb7b11a2"}})}(t).then((function(t){t.ok&&(e.classList.add("elements__heart_active"),r.push(o))})).then((function(){c.textContent++})).catch((function(e){return console.log(e)})),i.target.classList.toggle("elements__heart_active")}))}(d,c,n,u,a,s),function(e,t){e.querySelector(".elements__delet-icon").addEventListener("click",(function(){return function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-26/cards/".concat(e," "),{method:"DELETE",headers:{authorization:"019bbcb5-3c25-4998-9d5f-ecd3bb7b11a2"}})}(t).then((function(t){t.ok&&e.remove()})).catch((function(e){console.log(e)}))}))}(l,c),function(e,t,n){var r=document.querySelector("#popup-img"),c=document.querySelector(".popup__img"),i=document.querySelector(".popup__img-name");e.querySelector(".elements__img").addEventListener("click",(function(){c.src="".concat(n),c.alt="".concat(t),i.textContent=e.querySelector(".elements__discritpion").textContent,o(r)}))}(l,e,t),function(e,t){i().then((function(e){if(e.ok)return e.json()})).then((function(n){e!==n.name&&t.remove()})).catch((function(e){return console.log(e)}))}(r,f),function(e,t,n){i().then((function(e){if(e.ok)return e.json()})).then((function(o){for(var r=0;r<e;r++)o.name===t[r].name&&n.classList.add("elements__heart_active")})).catch((function(e){return console.log(e)}))}(n,a,d),l}fetch("https://nomoreparties.co/v1/plus-cohort-26/cards ",{headers:{authorization:"019bbcb5-3c25-4998-9d5f-ecd3bb7b11a2"}}).then((function(e){if(e.ok)return e.json()})).then((function(e){for(var t=0;t<e.length;t++)u.append(a(e[t].name,e[t].link,e[t].likes.length,e[t].owner.name,e[t]._id,e[t].owner,e[t].likes))})).catch((function(e){return console.log(e)}));var l=document.querySelector("#form-add"),s=(document.querySelector(".elements"),l.querySelector("#place-name-input")),f=l.querySelector("#src-name-input"),d=document.querySelector("#newCard"),m=document.querySelector(".profile__edit-button"),p=document.querySelectorAll(".popup__close-icon"),_=document.querySelector(".profile__add-button"),v=document.querySelector("#editProfile"),h=document.querySelector("#form-profile"),b=h.querySelector("#name-input"),y=h.querySelector("#description-input"),S=document.querySelector(".profile__name"),q=document.querySelector(".profile__description"),C=document.querySelector(".profile__avatar"),E=document.querySelector(".profile__overlay"),g=document.querySelector("#changeAvatar"),L=document.querySelector("#src-avatar-input"),k=document.querySelector("#form-changeAvatar");function x(){i().then((function(e){if(e.ok)return e.json()})).then((function(e){S.textContent=e.name,q.textContent=e.about,C.src=e.avatar})).catch((function(e){return console.log(e)}))}function A(e,t){if(e)t.textContent+="...";else if(!e){var n=t.textContent.split("");n.pop(),n.pop(),n.pop(),t.textContent=n.join("")}}n({formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_inactive",inputErrorClass:"form__input_error-redbot",errorClass:"form__input-error_active"}),l.addEventListener("submit",(function(e){e.preventDefault();var t,n,o=s.value,c=f.value,i=l.querySelector(".form__button");A(!0,i),(t=o,n=c,fetch("https://nomoreparties.co/v1/plus-cohort-26/cards",{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8",authorization:"019bbcb5-3c25-4998-9d5f-ecd3bb7b11a2"},body:JSON.stringify({name:t,link:n})})).then((function(e){e.ok&&window.location.reload()})).catch((function(e){return console.log(e)})).finally((function(){A(!1,i)})),r(d),e.target.reset()})),_.addEventListener("click",(function(){o(d),n({formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_inactive",inputErrorClass:"form__input_error-redbot",errorClass:"form__input-error_active"})})),m.addEventListener("click",(function(){b.value=S.textContent,y.value=q.textContent,o(v)})),E.addEventListener("click",(function(){o(g),L.value=C.src,n({formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_inactive",inputErrorClass:"form__input_error-redbot",errorClass:"form__input-error_active"})})),k.addEventListener("submit",(function(e){e.preventDefault();var t=L.value,n=k.querySelector(".form__button");A(!0,n),function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-26/users/me/avatar ",{method:"PATCH",headers:{authorization:"019bbcb5-3c25-4998-9d5f-ecd3bb7b11a2","Content-Type":"application/json"},body:JSON.stringify({avatar:e})})}(t).then((function(e){e.ok&&(r(g),x())})).catch((function(e){return console.log(e)})).finally((function(){A(!1,n)}))})),p.forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return r(t)}))})),h.addEventListener("submit",(function(e){var t,n,o;e.preventDefault(),S.textContent=b.value,q.textContent=y.value,t=b.value,n=y.value,A(!0,o=h.querySelector(".form__button")),function(e,t){return fetch("https://nomoreparties.co/v1/plus-cohort-26/users/me",{method:"PATCH",headers:{authorization:"019bbcb5-3c25-4998-9d5f-ecd3bb7b11a2","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})})}(t,n).then((function(e){e.ok&&x()})).catch((function(e){return console.log(e)})).finally((function(){A(!1,o)})),r(v)})),x()})();